<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='Main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <title>DermaLens โข Result</title>

    <style>
        :root {
            --brand-brown: #a18664;
        }

        /* ุชูุณููุงุช ููุญุฏุฉ ูุชูููุฒ ุงูุตูุญุฉ ุงููุดุทุฉ (ููุชูุงุณู) */
        .navigation .navLinks li a:hover,
        .navigation .navLinks li.active-page>a,
        .navigation .navLinks li.profile-menu.active-page>a {
            color: var(--brand-brown);
            font-weight: 600;
        }

        /* โ ุชูุณููุงุช ูุงุฆูุฉ ุงูููู ุงูุดุฎุตู ุงูููุญุฏุฉ */
        .profile-menu {
            position: relative;
        }

        .profile-menu .dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 180px;
            z-index: 10;
        }

        .profile-menu.active .dropdown {
            display: block;
        }

        .separator {
            height: 1px;
            background-color: #eee;
            margin: 5px 0;
        }

        /* ุชูุณููุงุช ุฃุฎุฑู ููุตูุญุฉ */
        .site-footer {
            /* ูุชุซุจูุช ููุถุนู ุจุงููุณุจุฉ ููุงูุฐุฉ ุงูุนุฑุถ */
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 1000;
        }
    </style>
</head>

<body>

    <div id="details-hw" class="header-wrapper">
        <header>
            <nav class="navigation container">
                <div class="logo">
                    <a href="{{ url_for('diagnosis') }}">DermaLens</a>
                </div>
                <ul class="navLinks">
                    <li><a href="{{ url_for('history') }}" data-key="history">History</a></li>
                    <li><a href="{{ url_for('community') }}" data-key="community">Community</a></li>
                    <li><a href="{{ url_for('about') }}" data-key="about">About</a></li>

                    <li class="profile-menu" id="profile-toggle">
                        <a href="#" title="Account Menu" id="profileDropdownToggle"><i class="fa-solid fa-circle-user"></i></a>

                        <div class="dropdown">
                            <a href="#" id="profileLink" data-key="profile">Profile</a>

                            <div class="separator"></div>

                            <div class="lang-options">
                                <a onclick="switchLang('ar')">ุนุฑุจู</a>
                                <a onclick="switchLang('en')">English</a>
                            </div>

                            <div class="separator" id="authSeparator"></div>

                            <a href="#" data-key="auth" id="authLink">Log Out</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>

        <div class="illness-hero">
            <p data-key="youhave">You Have a <span class="percentage">{% if confidence is not none %}{{ confidence }}%{% endif %}</span>
                <br>Chance that you have
            </p>
            <h1 data-key="diesase">{{ pred_name }}</h1>
        </div>

    </div>

    <div class="video-container">
        <video id="video" class="video" src="{{ url_for('static', filename='Pics/video.mp4') }}" autoplay muted loop></video>
    </div>

    <section class="details-sec">

        <div class="illness-card symptoms-card">
            <h3 data-key="Symptoms"><i class="fas fa-circle-notch illness-icon"></i>Symptoms</h3>
            <ul class="symptoms-list">
                <li class="symptom-item" data-key="s1">Ring-shaped, red, scaly patches</li>
                <li class="symptom-item" data-key="s2">Clear or healthy skin in the center</li>
                <li class="symptom-item" data-key="s3">Itchy, burning sensation</li>
                <li class="symptom-item" data-key="s4">Raised, bumpy border around patches</li>
                <li class="symptom-item" data-key="s5">Hair loss in affected areas</li>
                <li class="symptom-item" data-key="s6">Patches may overlap and spread</li>
            </ul>
        </div>

        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/images.jpg') }}" alt="Ringworm body locations">
            <div class="image-overlay">
                <p data-key="picalt1">Common sites of ringworm infection</p>
            </div>
        </div>

    </section>

    <section class="details-sec">
        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/skin-disease-human-health-problem-600nw-2530985179.webp') }}" alt="Ringworm symptoms">
            <div class="image-overlay">
                <p data-key="picalt2">Characteristic ring-shaped lesions</p>
            </div>
        </div>

        <div class="illness-card locations-card">
            <h3 data-key="appears"><i class="fas fa-map-marker-alt illness-icon"></i>It can appears in:</h3>
            <ul class="locations-list">
                <li class="location-item" data-key="a1">Scalp and beard area</li>
                <li class="location-item" data-key="a2">Arms and legs</li>
                <li class="location-item" data-key="a3">Torso and back</li>
                <li class="location-item" data-key="a4">Groin area</li>
                <li class="location-item" data-key="a5">Feet (athlete's foot)</li>
                <li class="location-item" data-key="a6">Between fingers and toes</li>
            </ul>
        </div>
    </section>

    <footer class="site-footer">
        <div class="container">Dermalens. Copyright DERMALENS. All Rights Reserved</div>
    </footer>

</body>

<script>
    // โ ุฏุงูุฉ ุชุณุฌูู ุงูุฎุฑูุฌ ุงูููุญุฏุฉ ูุงูููุฌูุฉ ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
    function logout() {
        localStorage.removeItem('token');
        localStorage.removeItem('loggedIn');
        const lang = localStorage.getItem('lang') || 'en';
        alert(lang === 'ar' ? 'ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ.' : 'Logged out successfully.');
        window.location.href = "{{ url_for('login') }}"; // ุงูุชูุฌูู ุฅูู ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
    }

    const ringwormVideo = document.getElementById('video');
    ringwormVideo.parentElement.addEventListener('mouseenter', () => ringwormVideo.setAttribute('controls', ''));
    ringwormVideo.parentElement.addEventListener('mouseleave', () => ringwormVideo.removeAttribute('controls'));

    /* Change the language */
    const translations = {
        ar: {
            history: "ุงูุณุฌู",
            community: "ุงููุฌุชูุน",
            about: "ุนูุง",
            profile: "ุงูููู ุงูุดุฎุตู", // โ ุชูุช ุงูุฅุถุงูุฉ
            login: "ุชุณุฌูู ุงูุฏุฎูู", // โ ุชูุช ุงูุฅุถุงูุฉ
            logout: "ุชุณุฌูู ุฎุฑูุฌ", // โ ุชูุช ุงูุฅุถุงูุฉ
            // ๐ก ุชู ุงูุชุนุฏูู: ุงุณุชุจุฏุงู ุงููุณุจุฉ ุงูุซุงุจุชุฉ ุจู {percentage}
            youhave: "ูุฏูู ุงุญุชูุงู ุจูุณุจุฉ {percentage}<br>ููุฅุตุงุจุฉ ุจู",
            diesase: "ุงูุณุนูุฉ (ุงูุชูููุง)",
            description: "ุนุฏูู ูุทุฑูุฉ ุดุงุฆุนุฉ ุชุตูุจ ุงูุฌูุฏุ ูุชุณุจุจ ุจูุนูุง ุญูุฑุงุก ูุชูุดุฑุฉ ุนูู ุดูู ุญููุงุช. ูุนูู ุงูุฑุบู ูู ุงุณููุงุ" +
                " ููู ูุง ุชูุชุฌ ุนู ุงูุฏูุฏุงู ุจู ุนู ุงููุทุฑูุงุชุ ูุชุนุฏ ุดุฏูุฏุฉ ุงูุนุฏูู.",
            Symptoms: "ุงูุฃุนุฑุงุถ",
            s1: "ุจูุน ุญูุฑุงุก ูุชูุดุฑุฉ ุนูู ุดูู ุญููุงุช",
            s2: "ูุฑูุฒ ุงูุจูุนุฉ ูุฏ ูููู ุดูุงููุง ุฃู ุณููููุง",
            s3: "ุญูุฉ ุฃู ุฅุญุณุงุณ ุจุงูุญุฑูุฉ",
            s4: "ุญุฏูุฏ ูุฑุชูุนุฉ ููุซุฎูุฉ ุญูู ุงูุจูุน",
            s5: "ุชุณุงูุท ุงูุดุนุฑ ูู ุงูููุงุทู ุงููุตุงุจุฉ",
            s6: "ุฅููุงููุฉ ุชุฏุงุฎู ุงูุจูุน ูุงูุชุดุงุฑูุง",
            picalt1: "ุงูููุงุทู ุงูุดุงุฆุนุฉ ูุนุฏูู ุงูุณุนูุฉ",
            picalt2: "ุงูุจูุน ุงููููุฒุฉ ุนูู ุดูู ุญููุงุช",
            appears: "ูุฏ ุชุธูุฑ ูู:",
            a1: "ูุฑูุฉ ุงูุฑุฃุณ ูููุทูุฉ ุงููุญูุฉ",
            a2: "ุงูุฐุฑุงุนุงู ูุงูุณุงูุงู",
            a3: "ุงูุฌุฐุน ูุงูุธูุฑ",
            a4: "ููุทูุฉ ุงูุฃุฑุจูุฉ",
            a5: "ุงููุฏููู (ูุฏู ุงูุฑูุงุถู)",
            a6: "ุจูู ุงุตุงุจุน ุงููุฏ ุฃู ุงููุฏู",
            treatments: "ุงูุนูุงุฌ"
        },
        en: {
            history: "History",
            community: "Community",
            about: "About",
            profile: "Profile", // โ ุชูุช ุงูุฅุถุงูุฉ
            login: "Log In", // โ ุชูุช ุงูุฅุถุงูุฉ
            logout: "Log Out", // โ ุชูุช ุงูุฅุถุงูุฉ
            // ๐ก ุชู ุงูุชุนุฏูู: ุงุณุชุจุฏุงู ุงููุณุจุฉ ุงูุซุงุจุชุฉ ุจู {percentage}
            youhave: "You Have a {percentage}<br>Chance that you have",
            diesase: "Ringworm",
            description: "A common fungal infection that affects the skin, creating ring-shaped," +
                " red, and scaly patches. Despite its name, it's not caused by worms but by fungi and is highly contagious",
            Symptoms: "Symptoms",
            s1: "Ring-shaped, red, scaly patches",
            s2: "Clear or healthy skin in the center",
            s3: "Itchy, burning sensation",
            s4: "Raised, bumpy border around patches",
            s5: "Hair loss in affected areas",
            s6: "Patches may overlap and spread",
            picalt1: "Common sites of ringworm infection",
            picalt2: "Characteristic ring-shaped lesions",
            appears: "It can appears in:",
            a1: "Scalp and beard area",
            a2: "Arms and legs",
            a3: "Torso and back",
            a4: "Groin area",
            a5: "Feet (athlete's foot)",
            a6: "Between fingers and toes",
            treatments: "Treatments"
        }
    };

    // โ ุฏุงูุฉ ูุชุญุฏูุซ ุฑุงุจุท ุงููุตุงุฏูุฉ (ุชุณุฌูู ุฏุฎูู/ุชุณุฌูู ุฎุฑูุฌ)
    function updateAuthLink(lang) {
        const authLink = document.getElementById('authLink');
        // ูุชู ุงุณุชุฎุฏุงู localStorage ูุชุญุฏูุฏ ุญุงูุฉ ุชุณุฌูู ุงูุฏุฎูู
        const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');

        if (!authLink) return;

        if (isLoggedIn) {
            authLink.textContent = translations[lang]['logout'];
            authLink.setAttribute('onclick', 'logout()');
            authLink.removeAttribute('href');
        } else {
            authLink.textContent = translations[lang]['login'];
            authLink.setAttribute('href', '{{ url_for('login') }}');
            authLink.removeAttribute('onclick');
        }
    }

    function switchLang(lang) {
        document.documentElement.lang = lang;
        document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";

        // ๐ก [ุชุนุฏูู ุฃุณุงุณู]: ุญูุธ ุงููุณุจุฉ ุงููุฆููุฉ ุงูุฏููุงููููุฉ ูุจู ุงูุชุจุฏูู
        const currentPercentage = document.querySelector('.percentage')?.textContent || "87%";

        document.querySelectorAll("[data-key]").forEach(el => {
            const key = el.dataset.key;
            let text = translations[lang][key];

            if (el.tagName === "INPUT" || el.tagName === "TEXTAREA") {
                el.placeholder = text;
            } else if (key === 'youhave' && text) {
                // ๐ก ุฏูุฌ ุงููุณุจุฉ ุงููุฆููุฉ ุงูุฏููุงููููุฉ ูุน ูุต ุงูุชุฑุฌูุฉ
                text = text.replace('{percentage}', `<span class="percentage">${currentPercentage}</span>`);
                el.innerHTML = text;
            } else if (text) {
                // ุงูุชุญูู ูู ูุฌูุฏ ุฃููููุงุช ูู ุงูุนูุงุตุฑ ุงูุชู ููุง data-key (ูุซู ุงูุฃุนุฑุงุถ ูุงูููุงุทู)
                const icon = el.querySelector('i');
                if (icon) {
                    el.innerHTML = '';
                    el.appendChild(icon);
                    el.appendChild(document.createTextNode(' ' + text));
                } else {
                    el.innerHTML = text;
                }
            }
        });
        // ูุชู ุชุญุฏูุซ ุฒุฑ ุงููุตุงุฏูุฉ ุจุนุฏ ุชุญุฏูุซ ุงููุบุฉ
        updateAuthLink(lang);
        // save the chosen lang in localStorage
        localStorage.setItem("lang", lang);
    }

    // Enhanced interactive features
    document.addEventListener('DOMContentLoaded', function () {
        // Image click to show larger version
        const images = document.querySelectorAll('.image-card img');
        images.forEach(img => {
            img.addEventListener('click', function () {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                    cursor: pointer;
                `;

                const largeImg = document.createElement('img');
                largeImg.src = this.src;
                largeImg.style.cssText = `
                    max-width: 90%;
                    max-height: 90%;
                    border-radius: 10px;
                `;

                overlay.appendChild(largeImg);
                document.body.appendChild(overlay);

                overlay.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                });
            });
        });

        // Add fade-in animation to cards
        const cards = document.querySelectorAll('.illness-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.classList.add('fade-in');
            }, index * 200);
        });

        // ๐ ุชุทุจูู ุงููุบุฉ ูููุทู ุงูููู ุงูุดุฎุตู ุงูููุญุฏ
        const savedLang = localStorage.getItem("lang") || "en";
        switchLang(savedLang);

        const profileToggle = document.getElementById('profile-toggle');
        const profileLink = document.getElementById('profileLink');

        // โ ุฅุถุงูุฉ ููุทู ุญูุงูุฉ ุงูุชูุฌูู ูุตูุญุฉ ุงูููู ุงูุดุฎุตู
        if (profileLink) {
            profileLink.addEventListener('click', function (event) {
                const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');
                const currentLang = localStorage.getItem('lang') || 'en';

                if (!isLoggedIn) {
                    event.preventDefault(); // ููุน ุงูุชูุฌูู ุงูุงูุชุฑุงุถู
                    alert(currentLang === 'ar' ? "ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ูุนุฑุถ ุงูููู ุงูุดุฎุตู." : "You must log in to view the profile.");
                    window.location.href = "{{ url_for('login') }}"; // ุงูุชูุฌูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
                } else {
                    window.location.href = "{{ url_for('profile') }}";
                }
                if (profileToggle) profileToggle.classList.remove('active');
            });
        }


        if (profileToggle) {
            profileToggle.addEventListener('click', function (event) {
                // ููุน ุงูุชููู ุฅุฐุง ุชู ุงูููุฑ ุนูู ุฃููููุฉ ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ
                if (event.target.tagName !== 'A' || event.target.id === 'profileDropdownToggle') {
                    event.preventDefault();
                }
                this.classList.toggle('active');
            });

            // ุฅุบูุงู ุงููุงุฆูุฉ ุนูุฏ ุงูููุฑ ุฎุงุฑุฌูุง
            document.addEventListener('click', (event) => {
                if (!profileToggle.contains(event.target)) {
                    profileToggle.classList.remove('active');
                }
            });
        }
    });
</script>

</html>