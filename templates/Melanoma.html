<!DOCTYPE html>
<html lang="en">

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='Main.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css">
    <title>DermaLens â€¢ Result</title>

    <style>
        :root {
            --brand-brown: #a18664;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù…ÙˆØ­Ø¯Ø© Ù„ØªÙ…ÙŠÙŠØ² Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ù„Ù„ØªÙ†Ø§Ø³Ù‚) */
        .navigation .navLinks li a:hover,
        .navigation .navLinks li.active-page>a,
        .navigation .navLinks li.profile-menu.active-page>a {
            color: var(--brand-brown);
            font-weight: 600;
        }

        /* âœ… ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© */
        .profile-menu {
            position: relative;
        }

        .profile-menu .dropdown {
            display: none;
            position: absolute;
            right: 0;
            top: 100%;
            background-color: white;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            padding: 10px 0;
            min-width: 180px;
            z-index: 10;
        }

        .profile-menu.active .dropdown {
            display: block;
        }

        .separator {
            height: 1px;
            background-color: #eee;
            margin: 5px 0;
        }

        /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø£Ø®Ø±Ù‰ Ù„Ù„ØµÙØ­Ø© */
        .site-footer {
            /* Ù„ØªØ«Ø¨ÙŠØª Ù…ÙˆØ¶Ø¹Ù‡ Ø¨Ø§Ù„Ù†Ø³Ø¨Ø© Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø¹Ø±Ø¶ */
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 1000;
        }
    </style>
</head>

<body>

    <div id="details-hw" class="header-wrapper">
        <header>
            <nav class="navigation container">
                <div class="logo">
                    <a href="{{ url_for('diagnosis') }}">DermaLens</a>
                </div>
                <ul class="navLinks">
                    <li><a href="{{ url_for('history') }}" data-key="history">History</a></li>
                    <li><a href="{{ url_for('community') }}" data-key="community">Community</a></li>
                    <li><a href="{{ url_for('about') }}" data-key="about">About</a></li>

                    <li class="profile-menu" id="profile-toggle">
                        <a href="#" title="Account Menu" id="profileDropdownToggle"><i class="fa-solid fa-circle-user"></i></a>

                        <div class="dropdown">
                            <a href="#" id="profileLink" data-key="profile">Profile</a>

                            <div class="separator"></div>

                            <div class="lang-options">
                                <a onclick="switchLang('ar')">Ø¹Ø±Ø¨ÙŠ</a>
                                <a onclick="switchLang('en')">English</a>
                            </div>

                            <div class="separator" id="authSeparator"></div>

                            <a href="#" data-key="auth" id="authLink">Log Out</a>
                        </div>
                    </li>
                </ul>
            </nav>
        </header>

        <div class="illness-hero">
            <p id="diagnosisResultTitle" data-key="youhave">You Have a <span class="percentage">{{ confidence }}%</span>
                <br>Chance that you have
            </p>

            <h1 id="diseaseNameDisplay">{{ pred_name }}</h1>

            <p class="description" data-key="description">A serious type of skin cancer that develops in melanocytes,
                the cells that produce pigment. It can be life-threatening if not caught early but is highly treatable
                when detected in early stages</p>
        </div>

    </div>

    <div class="video-container">
        <video id="video" class="video" src="{{ url_for('static', filename='Pics/video.mp4') }}" autoplay muted loop></video>
    </div>

    <section class="details-sec">

        <div class="illness-card symptoms-card">
            <h3 data-key="Symptoms"><i class="fas fa-exclamation-triangle illness-icon"></i>Symptoms</h3>
            <ul class="symptoms-list">
                <li class="symptom-item" data-key="s1">New moles or changes in existing moles</li>
                <li class="symptom-item" data-key="s2">Asymmetrical mole shape</li>
                <li class="symptom-item" data-key="s3">Irregular or blurred borders</li>
                <li class="symptom-item" data-key="s4">Color changes or multiple colors</li>
                <li class="symptom-item" data-key="s5">Diameter larger than 6mm</li>
                <li class="symptom-item" data-key="s6">Bleeding or itching moles</li>
            </ul>
        </div>

        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/images.jpg') }}" alt="Melanoma body locations">
            <div class="image-overlay">
                <p data-key="picalt1">Areas where melanoma commonly develops</p>
            </div>
        </div>

    </section>

    <section class="details-sec">
        <div class="illness-card image-card">
            <img src="{{ url_for('static', filename='Pics/skin-disease-human-health-problem-600nw-2530985179.webp') }}" alt="Melanoma symptoms">
            <div class="image-overlay">
                <p data-key="picalt2">Warning signs of melanoma</p>
            </div>
        </div>

        <div class="illness-card locations-card">
            <h3 data-key="appears"><i class="fas fa-map-marker-alt illness-icon"></i>It can appears in:</h3>
            <ul class="locations-list">
                <li class="location-item" data-key="a1">Back and chest</li>
                <li class="location-item" data-key="a2">Arms and legs</li>
                <li class="location-item" data-key="a3">Face and scalp</li>
                <li class="location-item" data-key="a4">Under fingernails</li>
                <li class="location-item" data-key="a5">Soles of feet</li>
                <li class="location-item" data-key="a6">Between toes</li>
            </ul>
        </div>
    </section>

    <footer class="site-footer">
        <div class="container">Dermalens. Copyright DERMALENS. All Rights Reserved</div>
    </footer>

</body>

<script>
    // âœ… Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…ÙˆØ­Ø¯Ø© ÙˆØ§Ù„Ù…ÙˆØ¬Ù‡Ø© Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    function logout() {
        localStorage.removeItem('token');
        localStorage.removeItem('loggedIn');
        const lang = localStorage.getItem('lang') || 'en';
        alert(lang === 'ar' ? 'ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬ Ø¨Ù†Ø¬Ø§Ø­.' : 'Logged out successfully.');
        window.location.href = "{{ url_for('login') }}"; // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    }

    const melanomaVideo = document.getElementById('video');
    melanomaVideo.parentElement.addEventListener('mouseenter', () => melanomaVideo.setAttribute('controls', ''));
    melanomaVideo.parentElement.addEventListener('mouseleave', () => melanomaVideo.removeAttribute('controls'));

    /* Change the language */
    const translations = {
        ar: {
            history: "Ø§Ù„Ø³Ø¬Ù„",
            community: "Ø§Ù„Ù…Ø¬ØªÙ…Ø¹",
            about: "Ø¹Ù†Ø§",
            profile: "Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            login: "ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            logout: "ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            // ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Placeholder
            youhave: "Ù„Ø¯ÙŠÙƒ Ø§Ø­ØªÙ…Ø§Ù„ Ø¨Ù†Ø³Ø¨Ø© {percentage}<br>Ù„Ù„Ø¥ØµØ§Ø¨Ø© Ø¨Ù€ {diagnosis}",
            description: "Ù†ÙˆØ¹ Ø®Ø·ÙŠØ± Ù…Ù† Ø³Ø±Ø·Ø§Ù† Ø§Ù„Ø¬Ù„Ø¯ ÙŠØªØ·ÙˆØ± ÙÙŠ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„ØµØ¨Ø§ØºÙŠØ© (Ø§Ù„Ù…ÙŠÙ„Ø§Ù†ÙˆØ³ÙŠØª)ØŒ ÙˆÙ‡ÙŠ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ù…Ø³Ø¤ÙˆÙ„Ø© Ø¹Ù† Ø¥Ù†ØªØ§Ø¬ Ø§Ù„ØµØ¨ØºØ©." +
                " Ù‚Ø¯ ÙŠØ´ÙƒÙ„ Ø®Ø·Ø±Ù‹Ø§ Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙŠØ§Ø© Ø¥Ø°Ø§ Ù„Ù… ÙŠÙÙƒØªØ´Ù Ù…Ø¨ÙƒØ±Ù‹Ø§ØŒ Ù„ÙƒÙ†Ù‡ Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø¹Ù„Ø§Ø¬ Ø¨Ø´ÙƒÙ„ ÙƒØ¨ÙŠØ± Ø¹Ù†Ø¯ Ø§ÙƒØªØ´Ø§ÙÙ‡ ÙÙŠ Ù…Ø±Ø§Ø­Ù„Ù‡ Ø§Ù„Ø£ÙˆÙ„Ù‰.",
            Symptoms: "Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶",
            s1: "Ø´Ø§Ù…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ø£Ùˆ ØªØºÙŠÙ‘Ø± ÙÙŠ Ø§Ù„Ø´Ø§Ù…Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø©",
            s2: "Ø´ÙƒÙ„ ØºÙŠØ± Ù…ØªÙ…Ø§Ø«Ù„ Ù„Ù„Ø´Ø§Ù…Ø©",
            s3: "Ø­Ø¯ÙˆØ¯ ØºÙŠØ± Ù…Ù†ØªØ¸Ù…Ø© Ø£Ùˆ ØºÙŠØ± ÙˆØ§Ø¶Ø­Ø©",
            s4: "ØªØºÙŠØ± ÙÙŠ Ø§Ù„Ù„ÙˆÙ† Ø£Ùˆ ÙˆØ¬ÙˆØ¯ Ø¹Ø¯Ø© Ø£Ù„ÙˆØ§Ù† ÙÙŠ Ø§Ù„Ø´Ø§Ù…Ø©",
            s5: "Ù‚Ø·Ø± Ø§Ù„Ø´Ø§Ù…Ø© ÙŠØ²ÙŠØ¯ Ø¹Ù† Ù¦ Ù…Ù„Ù…",
            s6: "Ø´Ø§Ù…Ø§Øª ØªÙ†Ø²Ù Ø£Ùˆ ØªØ³Ø¨Ø¨ Ø§Ù„Ø­ÙƒØ©",
            picalt1: "Ø§Ù„Ù…Ù†Ø§Ø·Ù‚ Ø§Ù„ØªÙŠ ÙŠØªØ·ÙˆØ± ÙÙŠÙ‡Ø§ Ø§Ù„Ù…ÙŠÙ„Ø§Ù†ÙˆÙ…Ø§ Ø¹Ø§Ø¯Ø©Ù‹",
            picalt2: "Ø¹Ù„Ø§Ù…Ø§Øª ØªØ­Ø°ÙŠØ±ÙŠØ© Ù…Ù† Ø§Ù„Ù…ÙŠÙ„Ø§Ù†ÙˆÙ…Ø§",
            appears: "Ù‚Ø¯ ØªØ¸Ù‡Ø± ÙÙŠ:",
            a1: "Ø§Ù„Ø¸Ù‡Ø± ÙˆØ§Ù„ØµØ¯Ø±",
            a2: "Ø§Ù„Ø°Ø±Ø§Ø¹Ø§Ù† ÙˆØ§Ù„Ø³Ø§Ù‚Ø§Ù†",
            a3: "Ø§Ù„ÙˆØ¬Ù‡ ÙˆÙØ±ÙˆØ© Ø§Ù„Ø±Ø£Ø³",
            a4: "ØªØ­Øª Ø§Ù„Ø£Ø¸Ø§ÙØ±",
            a5: "Ø¨Ø§Ø·Ù† Ø§Ù„Ù‚Ø¯Ù…ÙŠÙ†",
            a6: "Ø¨ÙŠÙ† Ø£ØµØ§Ø¨Ø¹ Ø§Ù„Ù‚Ø¯Ù…",
            treatments: "Ø§Ù„Ø¹Ù„Ø§Ø¬"
        },
        en: {
            history: "History",
            community: "Community",
            about: "About",
            profile: "Profile", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            login: "Log In", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            logout: "Log Out", // âœ… ØªÙ…Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ©
            // ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ø§Ù… Placeholder
            youhave: "You Have a {percentage}<br>Chance that you have {diagnosis}",
            description: "A serious type of skin cancer that develops in melanocytes, the cells that produce" +
                " pigment. It can be life-threatening if not caught early but is highly treatable when detected in early stages",
            Symptoms: "Symptoms",
            s1: "New moles or changes in existing moles",
            s2: "Asymmetrical mole shape",
            s3: "Irregular or blurred borders",
            s4: "Color changes or multiple colors",
            s5: "Diameter larger than 6mm",
            s6: "Bleeding or itching moles",
            picalt1: "Areas where melanoma commonly develops",
            picalt2: "Warning signs of melanoma",
            appears: "It can appears in:",
            a1: "Back and chest",
            a2: "Arms and legs",
            a3: "Face and scalp",
            a4: "Under fingernails",
            a5: "Soles of feet",
            a6: "Between toes",
            treatments: "Treatments"
        }
    };

    // âœ… Ø¯Ø§Ù„Ø© Ù„ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© (ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„/ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬)
    function updateAuthLink(lang) {
        const authLink = document.getElementById('authLink');
        // ÙŠØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… localStorage Ù„ØªØ­Ø¯ÙŠØ¯ Ø­Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');

        if (!authLink) return;

        if (isLoggedIn) {
            authLink.textContent = translations[lang]['logout'];
            authLink.setAttribute('onclick', 'logout()');
            authLink.removeAttribute('href');
        } else {
            authLink.textContent = translations[lang]['login'];
            authLink.setAttribute('href', '{{ url_for('login') }}');
            authLink.removeAttribute('onclick');
        }
    }


    function switchLang(lang) {
        document.documentElement.lang = lang;
        document.documentElement.dir = lang === "ar" ? "rtl" : "ltr";

        // ğŸ’¡ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ù…Ù† Ø§Ù„Ù€ DOM Ø¨Ø¹Ø¯ ØªØ¹ÙŠÙŠÙ†Ù‡Ø§ Ø¨ÙˆØ§Ø³Ø·Ø© Jinja2
        const currentPercentage = document.querySelector('.percentage')?.textContent || "87%";
        const currentDiagnosis = document.getElementById('diseaseNameDisplay')?.textContent || "Melanoma";


        document.querySelectorAll("[data-key]").forEach(el => {
            const key = el.dataset.key;
            let text = translations[lang][key];

            if (el.tagName === "INPUT" || el.tagName === "TEXTAREA") {
                el.placeholder = text;
            } else if (key === 'youhave' && text) {
                // ğŸ’¡ Ø¯Ù…Ø¬ Ø§Ù„Ù†Ø³Ø¨Ø© Ø§Ù„Ù…Ø¦ÙˆÙŠØ© ÙˆØ§Ø³Ù… Ø§Ù„ØªØ´Ø®ÙŠØµ Ù…Ø¹ Ù†Øµ Ø§Ù„ØªØ±Ø¬Ù…Ø©
                text = text.replace('{percentage}', `<span class="percentage">${currentPercentage}</span>`)
                    .replace('{diagnosis}', currentDiagnosis);
                el.innerHTML = text;
            } else if (text) {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø£ÙŠÙ‚ÙˆÙ†Ø§Øª ÙÙŠ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙŠ Ù„Ù‡Ø§ data-key
                const icon = el.querySelector('i');
                if (icon) {
                    el.innerHTML = '';
                    el.appendChild(icon);
                    el.appendChild(document.createTextNode(' ' + text));
                } else {
                    el.innerHTML = text;
                }
            }
        });

        // ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø²Ø± Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© Ø¨Ø¹Ø¯ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù„ØºØ©
        updateAuthLink(lang);
        // save the chosen lang in localStorage
        localStorage.setItem("lang", lang);
    }

    // Enhanced interactive features
    document.addEventListener('DOMContentLoaded', function () {
        // Image click to show larger version
        const images = document.querySelectorAll('.image-card img');
        images.forEach(img => {
            img.addEventListener('click', function () {
                const overlay = document.createElement('div');
                overlay.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background: rgba(0,0,0,0.8);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 1000;
                    cursor: pointer;
                `;

                const largeImg = document.createElement('img');
                largeImg.src = this.src;
                largeImg.style.cssText = `
                    max-width: 90%;
                    max-height: 90%;
                    border-radius: 10px;
                `;

                overlay.appendChild(largeImg);
                document.body.appendChild(overlay);

                overlay.addEventListener('click', () => {
                    document.body.removeChild(overlay);
                });
            });
        });

        // Add fade-in animation to cards
        const cards = document.querySelectorAll('.illness-card');
        cards.forEach((card, index) => {
            setTimeout(() => {
                card.classList.add('fade-in');
            }, index * 200);
        });

        // ğŸŒŸ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù„ØºØ© ÙˆÙ…Ù†Ø·Ù‚ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ Ø§Ù„Ù…ÙˆØ­Ø¯
        const savedLang = localStorage.getItem("lang") || "en";
        switchLang(savedLang);

        const profileToggle = document.getElementById('profile-toggle');
        const profileLink = document.getElementById('profileLink');

        // âœ… Ø¥Ø¶Ø§ÙØ© Ù…Ù†Ø·Ù‚ Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ
        if (profileLink) {
            profileLink.addEventListener('click', function (event) {
                const isLoggedIn = localStorage.getItem('loggedIn') === 'true' && localStorage.getItem('token');
                const currentLang = localStorage.getItem('lang') || 'en';

                if (!isLoggedIn) {
                    event.preventDefault(); // Ù…Ù†Ø¹ Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ
                    alert(currentLang === 'ar' ? "ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ù„Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠ." : "You must log in to view the profile.");
                    window.location.href = "{{ url_for('login') }}"; // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
                } else {
                    window.location.href = "{{ url_for('profile') }}";
                }
                if (profileToggle) profileToggle.classList.remove('active');
            });
        }


        if (profileToggle) {
            profileToggle.addEventListener('click', function (event) {
                // Ù…Ù†Ø¹ Ø§Ù„ØªÙ†Ù‚Ù„ Ø¥Ø°Ø§ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠÙ‚ÙˆÙ†Ø© Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
                if (event.target.tagName !== 'A' || event.target.id === 'profileDropdownToggle') {
                    event.preventDefault();
                }
                this.classList.toggle('active');
            });

            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            document.addEventListener('click', (event) => {
                if (!profileToggle.contains(event.target)) {
                    profileToggle.classList.remove('active');
                }
            });
        }
    });
</script>

</html>